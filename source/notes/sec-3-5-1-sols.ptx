<pretext>
    <article xml:id="notes">
        <worksheet xml:id="sec-3-5-1-sols">
        <title><m>\S 3.5</m>: Subspaces</title>
            <page>
                <exercise workspace="1in">
                    <title>Motivation: Subspaces</title>
                    <statement>
                        <p>
                            
                        </p>

                    </statement>
                    <solution>
                        <p>
                            We've devloped the concept of basis to help us describe <m>\real^n</m>. We'll now use it 
                            as a tool to help us describe important subsets of <m>\real^n</m>.
                        </p>
                    </solution>
                </exercise>
                <exercise workspace="6in">
                    <title>Preview Activity 3.5.1</title>
                    <introduction>
        <p> Let's consider the following matrix <m>A</m> and its reduced
        row echelon form.
        <me>
	  A = \left[\begin{array}{rrrr}
	  2 \amp -1 \amp 2 \amp 3 \\
	  1 \amp 0 \amp 0 \amp 2 \\
	  -2 \amp 2 \amp -4 \amp -2 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrr}
	  1 \amp 0 \amp 0 \amp 2 \\
	  0 \amp 1 \amp -2 \amp 1 \\
	  0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right]
        </me>.
        </p>
      </introduction>
                <task>
                    <statement>
	  <p> Are the columns of <m>A</m> linearly independent?  Is
	  the span of the columns <m>\real^3</m>?
	  </p>
        </statement>
        
        <solution>
	  <p> The columns of <m>A</m> are not linearly independent
	  since there is not a pivot position in every column.  Also,
	  the span of the columns is not <m>\real^3</m> because there
	  is not a pivot position in every row. </p>
        </solution>
      </task>

      <task >
        <statement>
	  <p> Give a parametric description of the solution space to
	  the homogeneous equation <m>A\xvec = \zerovec</m>. </p>
        </statement>
      
        <solution>
	  <p> From the reduced row echelon form, we see that the
	  homogeneous equation leads to the equations
	  <me>
	    \begin{alignedat}{5}
	    x_1 \amp  \amp  \amp  \amp  \amp  {}+{}  \amp 2x_4 \amp
	    {}={}  \amp 0 \\ 
	    \amp  \amp x_2 \amp  {}-{}  \amp 2x_3 \amp  {}+{}  \amp
	    x_4 \amp {}={}  \amp 0\text{,} \\ 
	    \end{alignedat}
	  </me>
	  which leads to the parametric description
	  <me>
	    \xvec=\fourvec{x_1}{x_2}{x_3}{x_4} =
	    \fourvec{-2x_4}{2x_3-x_4}{x_3}{x_4} =
	    x_3\fourvec{0}{2}{1}{0} + x_4\fourvec{2}{-1}{0}{1}\text{.}
	  </me>
	  </p>
        </solution>
      </task>

      <task >
        <statement>
	  <p> Explain how this parametric description produces two
	  vectors <m>\wvec_1</m> and <m>\wvec_2</m> whose span is the
	  solution space to the equation <m>A\xvec = \zerovec</m>.
	  </p>
        </statement>
     
        <solution>
	  <p> We see that every vector in the solution space is a
	  linear combination of the vectors
	  <m>\wvec_1=\fourvec{0}{2}{1}{0}</m> and <m>\wvec_2 =
	  \fourvec{2}{-1}{0}{1}</m>.
	  </p>
        </solution>
      </task>

      <task >
        <statement>
	  <p> What can you say about the linear independence of the
	  set of vectors <m>\wvec_1</m> and <m>\wvec_2</m>? </p>
        </statement>
     
        <solution>
	  <p> This pair of vectors is linearly independent because one
	  is not a scalar multiple of the other. </p>
        </solution>
      </task>

      <task>
        <statement>
	  <p> Let's denote the columns of <m>A</m> as
	  <m>\vvec_1</m>,
	  <m>\vvec_2</m>,
	  <m>\vvec_3</m>,  and
	  <m>\vvec_4</m>.
	  Explain why <m>\vvec_3</m> and <m>\vvec_4</m> can be written
	  as linear combinations of <m>\vvec_1</m> and <m>\vvec_2</m>.
	  </p>
        </statement>
       
        <solution>
	  <p> From the reduced row echelon form of <m>A</m>, we
	  see that <m>\vvec_3 = -2\vvec_2</m> and
	  <m>\vvec_4=2\vvec_1+\vvec_2</m>. </p>
        </solution>
      </task>

      <task >
        <statement>
	  <p> Explain why <m>\vvec_1</m> and <m>\vvec_2</m> are
	  linearly independent and <me>\laspan{\vvec_1,\vvec_2} =
	  \laspan{\vvec_1, \vvec_2, \vvec_3, \vvec_4}.</me>
	  </p>
        </statement>
       
        <solution>
	  <p> We see that <m>\vvec_1</m> and <m>\vvec_2</m> are
	  linearly independent from the reduced row echelon form of
	  <m>A</m>.  Moreover, we know that <m>\vvec_3</m> and
	  <m>\vvec_4</m> can be written as linear combinations of
	  <m>\vvec_1</m> and <m>\vvec_2</m>.  Therefore, any linear
	  combination of <m>\vvec_1</m>, <m>\vvec_2</m>,
	  <m>\vvec_3</m>, and <m>\vvec_4</m> can be written as a
	  linear combination of <m>\vvec_1</m> and <m>\vvec_2</m>
	  alone. </p>
        </solution>
      </task>
                    
                    
                </exercise>
    

            
                <exercise workspace="2in">
                    <title>Definition: Subspace</title>
                    <statement>
                        <p>
                            A <term>subspace</term> of <m>\R^n</m> is a 
                        </p>
                    </statement>
                    <solution>
                        <p>
                            subset which is the span of a set of vectors.
                        </p>
                        <p>
                            Note subset and subspace are not equivalent!
                        </p>
                    </solution>
                    
                </exercise>
            </page>
            <page>
                <exercise workspace="7in">
                    <title>Activity: Subspaces</title>
                    <statement>
	<p>
	  We will look at some sets of vectors and
	  the subspaces they form.
	  <ol marker="a.">
	    <li>
	      <p>
		If <m>\vvec_1, \vvec_2,\ldots,\vvec_n</m> is a set of
		vectors in <m>\real^m</m>, explain why <m>\zerovec</m> can
		be expressed as a 
		linear combination of these vectors.  Use this fact to
		explain why the zero vector <m>\zerovec</m> belongs to any
		subspace in <m>\real^m</m>.  
	      </p>
	    </li>

	    <li>
	      <p>
		Explain why the line on the left of <xref
		ref="figure-lines-r2-sol"/> is not a subspace of
		<m>\real^2</m> and why the line on the right is.
	      </p>

	      <figure xml:id="figure-lines-r2-sol">
		<caption> Two lines in <m>\real^2</m>, one of which is a
		subspace and one of which is not.
		</caption>
		<sidebyside widths="40% 40%" margins="5% 5%">
		  <image source="images/subspace-line-skew.svg" />
		  <image source="images/subspace-line-origin.svg" />
		</sidebyside>
	      </figure>
	    </li>

	    <li>
	      <p>
		Consider the vectors
		<me>
		  \vvec_1=\threevec101,~~~
		  \vvec_2=\threevec011,~~~
		  \vvec_3=\threevec110,
		</me>
		and describe the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3}</m> of
		<m>\real^3</m>.
		<sage>
		  <input>
		  </input>
		</sage>
	      </p>
	    </li>

	    <li>
	      <p>
		Consider the vectors
		<me>
		  \wvec_1=\threevec210,~~~
		  \wvec_2=\threevec{-1}1{-1},~~~
		  \wvec_3=\threevec03{-2}
		</me>
		<ol marker="1.">
		  <li>
		    <p>
		      Write <m>\wvec_3</m> as a linear combination of
		      <m>\wvec_1</m> and <m>\wvec_2</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Explain why <m>\laspan{\wvec_1,\wvec_2,\wvec_3} =
		      \laspan{\wvec_1, \wvec_2}</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Describe the subspace <m>S =
		      \laspan{\wvec_1,\wvec_2,\wvec_3}</m> of <m>\real^3</m>.
		    </p>
		  </li>
		</ol>
	      </p>
	    </li>
	    <li>
	      <p>
		Suppose that <m>\vvec_1</m>, <m>\vvec_2</m>,
		<m>\vvec_3</m>, and <m>\vvec_4</m> are four vectors in
		<m>\real^3</m> and that
		<me>
		  \begin{bmatrix}
		  \vvec_1 \amp \vvec_2 \amp \vvec_3 \amp \vvec_4
		  \end{bmatrix}
		  \sim
		  \begin{bmatrix}
		  1 \amp 2 \amp 0 \amp -2 \\
		  0 \amp 0 \amp 1 \amp 1 \\
		  0 \amp 0 \amp 0 \amp 0 \\
		  \end{bmatrix}.
		</me>
		Give a description of the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3,\vvec_4}</m> of
		<m>\real^3</m>. 
	      </p>
	    </li>
	  </ol>
	</p>
      </statement>

      <solution>
	<p>
	  <ol marker="a.">
	    <li>
	      <p>
		If we choose all the weights <m>c_1=c_2=\ldots=c_n =
		0</m>, then the linear combination
		<me>
		  c_1\vvec_1 + c_2\vvec_2 + \cdots + c_n\vvec_n = \zerovec.
		</me>
		This means that <m>\zerovec</m> is the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\ldots,\vvec_n}</m>. 		
	      </p>
	    </li>
	    <li>
	      <p>
		The line on the left cannot be a subspace of
		<m>\real^2</m> since it does not contain the zero
		vector.  The line on the right is a subspace because
		it can be represented as the span of any nonzero
		vector on the line.
	      </p>
	    </li>
	    <li>
	      <p>
		The matrix whose columns are the given vectors has a
		pivot in every row.  Therefore, the span of these
		vectors is <m>\real^3</m> and so
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3} = \real^3</m>.
	      </p>
	    </li>
	    <li>
	      <p>
		<ol marker="1.">
		  <li>
		    <p>
		      We see that <m>\wvec_3 = \wvec_1 + 2\wvec_2</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Any linear combination
		      <me>
			c_1\wvec_1 + c_2\wvec_2 + c_2\wvec_3 =
			(c_1 + c_2)\wvec_1 + (c_2+2c_2)\wvec_2.
		      </me>
		    </p>
		  </li>
		  <li>
		    <p>
		      The subspace
		      <m>S=\laspan{\wvec_1,\wvec_2,\wvec_3} =
		      \laspan{\wvec_1,\wvec_2}</m> is a plane in
		      <m>\real^3</m>. 
		    </p>
		  </li>
		</ol>
	      </p>
	    </li>
	    <li>
	      <p>
		Since we can write <m>\vvec_2 = 2\vvec_1</m> and
		<m>\vvec_4 = -2\vvec_1 + \vvec_2</m>, then
		<me>
		  S = \laspan{\vvec_1,\vvec_2,\vvec_3,\vvec_4} =
		  \laspan{\vvec_1,\vvec_3},
		</me>
		which is a plane in <m>\real^3</m>.
	      </p>
	    </li>
	  </ol>
	</p>
      </solution>
                    
                    
                </exercise>
            </page>
            <page>
                <exercise workspace="2in">
                    <title>Definition: Basis</title>
                    <statement>
                        <p>
                            Just as with <m>\real^n</m>, we are typically interested in representing a subspace 
                            efficiently.
                        </p>
                        <p>
                            A <term>basis</term> for a subspace <m>S</m> of <m>\real^n</m> is
                        </p>
                    </statement>
                    <solution>
                        <p>
                            a set of vectors which span <m>S</m> and are linearly independent.
                        </p>
                        <p>
                            The <term>dimension</term> of <m>S</m>, written <m>\text{dim}(S)</m>, is the number 
                            of non-zero vectors in any basis.
                        </p>
                    </solution>
                    
                    
                </exercise>
                <exercise workspace="2in">
                    <title>Two Important Subspaces</title>
                    <statement>
                        <p>
                            Given a matrix <m>A</m>, there are two important subspaces that we've seen previously:
                        </p>
                    </statement>
                    <solution>
                        <p>
                            <ol>
                                <li>
                                    <p>
                                        The span of its column vectors, and
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        The solution space of <m>A\xvec = \zerovec</m>.
                                    </p>
                                </li>
                            </ol>
                        </p>
                    </solution>
                    
                </exercise>
                <exercise workspace="3in">
                    <title>Definition: Column Space</title>
                    <statement>
                        <p>
                            If <m>A</m> is an <m>m \times n</m> matrix, then 
                        </p>
                    </statement>
                    <solution>
                        <p>
                            the span of its columns is the <term>column space</term> of <m>A</m>, written
                            <m>\col(A)</m>.
                        </p>
                    </solution>
                    
                </exercise>
            </page>
            <page>
                <exercise>
                    <title>Activity: Column Space</title>
                    <statement>
      <p> We will explore some column spaces in this activity.
      <ol marker="a.">
	<li><p>
	  Consider the matrix
	  <me>A= \left[\begin{array}{rrr}
	  \vvec_1 \amp \vvec_2 \amp \vvec_3
	  \end{array}\right]
	  =
	  \left[\begin{array}{rrr}
	  1 \amp 3 \amp -1 \\
	  -2 \amp 0 \amp -4 \\
	  1 \amp 2 \amp 0 \\
	  \end{array}\right].
	  </me>
	  Since <m>\col(A)</m> is the span of the columns,
	  we have
	  <me>
	    \col(A) = \laspan{\vvec_1,\vvec_2,\vvec_3}.
	  </me>
	  Explain why <m>\vvec_3</m> can be written as a linear
	  combination of <m>\vvec_1</m> and <m>\vvec_2</m> and
	  why <m>\col(A)=\laspan{\vvec_1,\vvec_2}</m>.
	</p> </li>

	<li><p> Explain why the vectors <m>\vvec_1</m> and
	<m>\vvec_2</m> form a basis for <m>\col(A)</m> and why
	<m>\col(A)</m> is a 2-dimensional subspace of
	<m>\real^3</m> and therefore a plane. </p></li>

	<li><p> Now consider the matrix <m>B</m> and its reduced row
	echelon form:
	<me>
	  B = \left[\begin{array}{rrrr}
	  -2 \amp -4 \amp 0 \amp 6 \\
	  1 \amp 2 \amp 0 \amp -3 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrr}
	  1 \amp 2 \amp 0 \amp -3 \\
	  0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right].
	</me>
	Explain why <m>\col(B)</m> is a 1-dimensional
	subspace of <m>\real^2</m> and is therefore a line.
	</p></li>

	<li><p> For a general matrix <m>A</m>, what is the
	relationship between the dimension 
	<m>\dim~\col(A)</m> and the number of pivot positions in
	<m>A</m>? </p></li>

	<li><p> How does the location of the pivot positions indicate
	a basis for <m>\col(A)</m>?
	</p></li>

	<li><p> If <m>A</m> is an invertible <m>9\times9</m> matrix,
	what can you say about the column space <m>\col(A)</m>?
	</p></li>

	<li>
	  <p> Suppose that <m>A</m> is an <m>8\times 10</m> matrix and
	  that <m>\col(A) = \real^8</m>.  If <m>\bvec</m> is an
	  8-dimensional vector, what can you say about the equation
	  <m>A\xvec = \bvec</m>?
	  </p>
	</li>

      </ol></p>
      </statement>

      <solution>
	<p><ol marker="a.">
	  <li><p>  We have
	  <me>A=\left[\begin{array}{rrr}
	  1 \amp 3 \amp -1 \\
	  -2 \amp 0 \amp -4 \\
	  1 \amp 2 \amp 0 \\
	  \end{array}\right]\sim
	  \left[\begin{array}{rrr}
	  1 \amp 0 \amp 2 \\
	  0 \amp 1 \amp -1 \\
	  0 \amp 0 \amp 0 \\
	  \end{array}\right]\text{,}
	  </me>
	  which shows that the vectors are not linearly
	  independent and, in fact, that <m>\vvec_3 = 2\vvec_1 -
	  \vvec_2</m>.  As we've seen several times, this means that
	  any linear combination of <m>\vvec_1</m>, <m>\vvec_2</m>, and
	  <m>\vvec_3</m> can be written as a linear combination of
	  <m>\vvec_1</m> and <m>\vvec_2</m> alone and hence that
	  <me>\col(A)=\laspan{\vvec_1,\vvec_2,\vvec_3} =
	  \laspan{\vvec_1,\vvec_2}.</me>  
	  </p></li>

	  <li><p> The reduced row echelon form of <m>A</m> shows that
	  <m>\vvec_1</m> and <m>\vvec_2</m> are linearly independent.
	  We also know that the span of these two vectors is
	  <m>\col(A)</m>.  Therefore, they form a basis for
	  <m>\col(A)</m>. </p></li>

	  <li><p> Denoting the columns of <m>B</m> as <m>\vvec_i</m>,
	  the reduced row echelon form shows that
	  <m>\vvec_2=2\vvec_1</m>, <m>\vvec_3=0\vvec_1</m>, and
	  <m>\vvec_4 = -3\vvec_1</m>.
	  Therefore, any linear combination of <m>\vvec_1</m>,
	  <m>\vvec_2</m>, <m>\vvec_3</m>, and <m>\vvec_4</m> can be
	  written as a linear combination of <m>\vvec_1</m>
	  alone.  This means that <m>\vvec_1</m> forms a basis for
	  <m>\col(A)</m>, which is then the line consisting of all
	  scalar multiples of <m>\vvec_1</m>.
p	  </p></li>

	  <li><p> The number of vectors in a basis of <m>\col(A)</m>
	  equals the number of pivot positions.  Therefore,
	  <m>\dim~\col(A)</m> equals the number of pivot positions in
	  <m>A</m>. </p></li>

	  <li><p> As the examples in this activity illustrate, the
	  columns of <m>A</m> that contain pivot positions form a
	  basis for <m>\col(A)</m>.
	  </p></li>

	  <li><p> If <m>A</m> is invertible, then it has a pivot
	  position in every row, which means that the span of the
	  columns is <m>\real^9</m>.  Therefore, <m>\col(A) =
	  \real^9</m>. </p></li>

	  <li><p> Since <m>\col(A)=\real^8</m>, we know that every
	  8-dimensional vector <m>\bvec</m> is in <m>\col(A)</m>.
	  This means that <m>\bvec</m> is in the span of the columns
	  of <m>A</m> so the equation <m>A\xvec = \bvec</m> must be
	  consistent. </p></li>

	</ol></p>
      </solution>
                    
                </exercise>
            </page>

            <page>
                <exercise workspace="3in">
                    <title>Definition: Rank</title>
                    <statement>
                        <p>
                            Pivot positions are important in helping us determine both the dimension of <m>\col(A)</m> and 
                            a basis for <m>\col(A)</m>.
                        </p>
                        <p>
                            The <term>rank</term> of a matrix <m>A</m> is 
                        </p>
                    </statement>
                    <solution>
                        <p>
                            the number of pivot positions in <m>A</m>, written <m>\text{rank}(A)</m>.
                        </p>
                    </solution>
                    
                </exercise>
                <exercise workspace="3in">
                    <title>Summary: Column Space and Rank</title>
                    <statement>
                        <p>
                            If <m>A</m> is an <m>m \times n</m> matrix, then
                        </p>
                    </statement>
                    <solution>
                        <p>
                            <ol>
                                <li>
                                    <p>
                                        <m>\col(A)</m> is a subspace of <m>\real^n</m>,
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <m>\text{dim}(\col(A))= \text{rank}(A)</m>, and
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        columns of <m>A</m> containing pivots form a basis for <m>\col(A)</m>.
                                    </p>
                                </li>
                            </ol>
                        </p>
                    </solution>
                    
                </exercise>
            </page>

        </worksheet>
    </article>
</pretext>
