<pretext>
    <article xml:id="notes">
        <worksheet xml:id="sec-4-3-2-sols">
        <title><m>\S 4.3</m>: Matrix Powers and Similarity (Solutions)</title>
            <page>
                <exercise workspace="2in">
                    <title>Motivation: Matrix Powers and Similarity</title>
                    <statement>
                        <p>
                            
                        </p>
                    </statement>

                    <solution>
                        <p>
                            We've defined what it means for <m>A</m> to be diagonalizable. We'll see examples of when 
                            this can be useful computationally, and also generalize the concept for matrices that are not
                            diagonalizable.
                        </p>
                    </solution>
                </exercise>

                <exercise workspace="0.5in">
                    <title>Activity: Diagonalization</title>
                    <statement>
      <p>
	<ol marker="a.">
	  <li><p> Find a diagonalization of <m>A</m>, if one exists,
	  when
	  <me>
	    A = \left[\begin{array}{rr}
	    3 \amp -2 \\
	    6 \amp -5 \\
	    \end{array}\right]
	  </me>.
	  </p></li>

	  <li><p> Can the diagonal matrix
	  <me>
	    A = \left[\begin{array}{rr}
	    2 \amp 0 \\
	    0 \amp -5 \\
	    \end{array}\right]
	  </me>
	  be diagonalized?  If so, explain how to find the matrices
	  <m>P</m> and <m>D</m>.
	  </p></li>

	  <li><p> Find a diagonalization of <m>A</m>, if one exists,
	  when
	  <me>
	    A = \left[\begin{array}{rrr}
	    -2 \amp 0 \amp 0 \\
	    1 \amp -3\amp 0 \\
	    2 \amp 0 \amp -3 \\
	    \end{array}\right]
	  </me>.
	</p>
	<sage>
	  <input>
	  </input>
	</sage>
	  </li>

	  <li><p> Find a diagonalization of <m>A</m>, if one exists,
	  when
	  <me>
	    A = \left[\begin{array}{rrr}
	    -2 \amp 0 \amp 0 \\
	    1 \amp -3\amp 0 \\
	    2 \amp 1 \amp -3 \\
	    \end{array}\right]
	  </me>.
	</p>
	<sage>
	  <input>
	  </input>
	</sage>
	  </li>

	  <li><p> Suppose that <m>A=PDP^{-1}</m> where
	  <me>
	    D = \left[\begin{array}{rr}
	    3 \amp 0 \\
	    0 \amp -1 \\
	    \end{array}\right],\qquad
	    P = \left[\begin{array}{cc} \vvec_2 \amp \vvec_1
	    \end{array}\right] = 
	    \left[\begin{array}{rr}
	    2 \amp 2 \\
	    1 \amp -1 \\
	    \end{array}\right]
	  </me>.
	  <ol marker="1.">
	    <li><p> Explain why <m>A</m> is invertible. </p></li>
	    <li><p> Find a diagonalization of <m>A^{-1}</m>. </p></li>
	    <li><p> Find a diagonalization of <m>A^3</m>. </p></li>
	  </ol></p></li>
	</ol>
      </p>
      </statement>

      <solution>
	<p><ol marker="a.">
	  <li><p> We find that <m>A</m> has eigenvectors
	  <m>\vvec_1=\twovec11</m> with associated eigenvalue
	  <m>\lambda_1=1</m> and <m>\vvec_2=\twovec{1}{3}</m> with
	  associated eigenvalue <m>\lambda_2=-3</m>.  We then have
	  <m>P=\mattwo1113</m> and <m>D=\mattwo100{-3}</m>. </p></li>

	  <li><p> Yes.  We know that the eigenvectors are
	  <m>\vvec_1=\twovec10</m> with associated eigenvalue
	  <m>\lambda_1=2</m> and <m>\vvec_2=\twovec01</m> with
	  associated eigenvalue <m>\lambda_2=-5</m>.  Therefore, <m>P
	  = \left[\begin{array}{rr}\vvec_1 \amp \vvec_2
	  \end{array}\right] = \mattwo1001=I</m> and
	  <m>D=\mattwo200{-5}=A</m>.  This shows that the
	  diagonalization is <m>A=IAI^{-1}</m>; that is, since
	  <m>A</m> is already diagonal, it is diagonalized by the
	  identity matrix. </p></li>

	  <li><p> We find eigenvectors <m>\vvec_1=\threevec112</m>,
	  <m>\vvec_2=\threevec010</m>, and <m>\vvec_3=\threevec001</m> 
	  with associated eigenvalues <m>\lambda_1=-2</m>,
	  <m>\lambda_2=-3</m>, and <m>\lambda_3=-3</m>.  Therefore,
	  <m>A = PDP^{-1}</m> where
	  <me>
	    P = \left[\begin{array}{rrr}
	    1 \amp 0 \amp 0 \\
	    1 \amp 1 \amp 0 \\
	    2 \amp 0 \amp 1 \\
	    \end{array}\right], 
	    D = \left[\begin{array}{rrr}
	    -2 \amp 0 \amp 0 \\
	    0 \amp -3 \amp 0 \\
	    0 \amp 0 \amp -3 \\
	    \end{array}\right]\text{.}
	  </me>
	  </p></li>

	  <li><p> Once again, we see that <m>\lambda=-2</m> is an
	  eigenvalue with multiplicity one and <m>\lambda=-3</m> is an
	  eigenvalue with multiplicity two.  However, <m>\dim E_{-3} =
	  1</m> so we are not able to find a basis for <m>\real^3</m>
	  consisting of eigenvalues of <m>A</m>.  Therefore, <m>A</m>
	  is not diagonalizable. </p></li>

	  <li><p> If <m>A=PDP^{-1}</m>,
	  <ol marker="1..">
	    <li><p> <m>A</m> is invertible since <m>\det A = \det D =
	    -3</m>. </p></li>

	    <li><p> We know that <m>\vvec_1</m> and <m>\vvec_2</m> are
	    eigenvectors of <m>A</m> with associated eigenvalues
	    <m>\lambda_1=3</m> and <m>\lambda_2=-1</m>.  If
	    <m>\vvec</m> is an eigenvector of <m>A</m> with associated
	    eigenvalue <m>\lambda</m>, then <m>\vvec</m> is an
	    eigenvector of <m>A^{-1}</m> with associated eigenvalue
	    <m>\frac1{\lambda}</m>.  Therefore, <m>A^{-1} =
	    PEP^{-1}</m> where <m>E =
	    \mattwo{\frac13}00{-1}</m>. </p></li>

	    <li><p> We have <m>A^3=PFP^{-1}</m> where
	    <m>F=\mattwo{27}00{-1}</m>. </p></li>
	  </ol>
	  </p></li>
	</ol></p>
      </solution>
                    
                    
                </exercise>

            </page>

            <page>
                <exercise workspace="4in">
                    <title>Fact: Powers and Inverses</title>
                    <statement>
                        <p>
                            If <m>A = PDP^{-1}</m>, then
                        </p>
                    </statement>
                    <solution>
                        <p>
                            <ol>
                                <li>
                                    <p>
                                        <m>A^k = PD^k P^{-1}</m>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <m>A^{-1} = PD^{-1} P^{-1}</m>
                                    </p>
                                </li>
                            </ol>
                        </p>
                    </solution>
                    
                </exercise>

                <exercise workspace="4in">
                    <title>Example: Dynamical Systems</title>
                    <statement>
                        <p>
                            Suppose <m>A</m> is a transition matrix for some system. That is,
                            <me>
                                \xvec_k = A^k \xvec_0
                            </me>.
                            
                        </p>
                    </statement>
                    <solution>
                        <p>
                            Then the eigenvalues of <m>A</m> will help determine how the system will behave.
                            See <url href="https://understandinglinearalgebra.org/sec-eigen-diag.html#sec-eigen-diag-4-6">Example 4.3.10</url>.
                        </p>
                    </solution>
                    
                </exercise>
            </page>

            <page>
                <exercise workspace="3in">
                    <title>Non-diagonalizable Matrices</title>
                    <statement>
                        <p>
                            There is a related definition that is useful when matrices are not diagonalizable.
                        </p>
                        <p>
                            We say a matrix <m>A</m> is <term>similar</term> to a matrix <m>B</m> if there exists an
                            invertible matrix <m>P</m> such that
                        </p>
                    </statement>
                    <solution>
                        <p>
                            <m>A = PBP^{-1}</m>.
                        </p>
                    </solution>
                    
                </exercise>

                <exercise workspace="5in">
                    <title><m>2 \times 2</m> Matrices with Complex Eigenvalues</title>
                    
                    
                    <statement>
                        <p>
                            Let <m>A = \begin{bmatrix} 0 \amp 1 \\ -1 \amp 0 \end{bmatrix}</m>.
                        </p>
                    </statement>
                    <solution>
                        <p>
                            Then the eigenvalues are when <m>\text{det}(A - \lambda I) = \lambda^2 + 1 = 0</m>, which is 
                            <m>\lambda = \pm i</m>.
                        </p>
                        <p>
                            See this <url href="https://understandinglinearalgebra.org/sec-eigen-diag.html#sec-eigen-diag-5-5">short discussion in the textbook</url> for a review of how we can represent 
                            complex numbers in polar coordinates, which will be important for analyzing these matrices.
                        </p>
                    </solution>
                </exercise>
            </page>

            <page>
                <exercise>
                    <title>Activity: <m>2 \times 2</m> Matrices with Complex Eigenvalues</title>
                    <statement>
	<p> We begin by rewriting
	<m>C</m> in terms of <m>r</m> and
	  <m>\theta</m> and noting that
	  <me>
	    C = 
	    \left[\begin{array}{rr}
	    a \amp -b \\
	    b \amp a \\
	    \end{array}\right]
	    = 
	    \left[\begin{array}{rr}
	    r\cos\theta \amp -r\sin\theta \\
	    r\sin\theta \amp r\cos\theta \\
	    \end{array}\right]
	    =
	    \left[\begin{array}{rr}
	    r \amp 0 \\
	    0 \amp r \\
	    \end{array}\right]
	    \left[\begin{array}{rr}
	    \cos\theta \amp -\sin\theta \\
	    \sin\theta \amp \cos\theta \\
	    \end{array}\right].
	  </me>
	  <ol marker="a.">
	    <li><p> Explain why <m>C</m> has the geometric effect of
	    rotating vectors by <m>\theta</m> and scaling them by a
	    factor of <m>r</m>. </p></li>
	    
	    <li><p> Let's now consider the matrix
	    <me>
	      A = \left[\begin{array}{rr}
	      -2 \amp 2  \\
	      -5 \amp 4 \\
	      \end{array}\right]
	    </me>
	    whose eigenvalues are <m>\lambda_1 = 1+i</m> and <m>\lambda_2 =
	    1-i</m>.  We will choose to focus on one of the eigenvalues
	    <m>\lambda_1 = a+bi= 1+i. </m> </p>
	    
	    <p> Form the matrix <m>C</m> using these values of <m>a</m>
	    and <m>b</m>.  Then rewrite the point <m>(a,b)</m> in polar
	    coordinates by identifying the values of <m>r</m> and
	    <m>\theta</m>.  Explain the geometric effect of multiplying
	    vectors by <m>C</m>. </p>
	    </li>
	    
	    <li><p> Suppose that
	    <m>P=\left[\begin{array}{rr}
	    1 \amp 1 \\
	    2 \amp 1 \\
	    \end{array}\right]
	    </m>.  Verify that <m>A = PCP^{-1}</m>. </p>
	    
	    <sage>
	      <input>
C = 
P = 
P*C*P.inverse()
	      </input>
	    </sage>
	    </li>
	    
	    <li><p> Explain why <m>A^k = PC^kP^{-1}</m>. </p></li>
	    
	    <li><p> We formed the matrix <m>C</m> by choosing the
	    eigenvalue <m>\lambda_1=1+i</m>.  Suppose we had instead
	    chosen <m>\lambda_2 = 1-i</m>.  Form the matrix <m>C'</m> and
	    use polar coordinates to describe the geometric effect of
	    <m>C'</m>.  </p></li>
	    
	    <li><p> Using the matrix
	    <m>
	      P' = \left[\begin{array}{rr}
	      1 \amp -1 \\
	      2 \amp -1 \\
	      \end{array}\right]
	      </m>, show that <m>A = P'C'P'^{-1}</m>.
	    </p></li>
	</ol></p>
      </statement>
                    
      <solution>
	<p><ol marker="a.">
	  <li><p> The matrix <m>S=\mattwo r00r</m> has the geometric
	  effect of scaling vectors uniformly by a factor of
	  <m>r</m> while the matrix
	  <m>R=\mattwo{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}</m>
	  rotates vectors by <m>\theta</m>. </p></li>

	  <li><p> We have <m>a=b=1</m> so we form the matrix
	  <m>C=\mattwo1{-1}11 =
	  \mattwo{\sqrt{2}}00{\sqrt{2}}
	  \mattwo{\cos(45^\circ)}{-\sin(45^\circ)}
	  {\sin(45^\circ)}{\cos(45^\circ)}</m>.  This shows that
	  <m>C</m> will scale vectors by a factor of <m>\sqrt2</m>
	  while rotating them by <m>45^\circ</m>. </p></li>

	  <li><p> Sage will verify this relationship.
	  </p></li>

	  <li><p> As we saw earlier, we have <m>A^2 =
	  (PCP^{-1})(PCP^{-1}) = PC^2P^{-1}</m> and hence <m>A^k =
	  PC^kP^{-1}</m>. </p></li>

	  <li><p> We have <m>a=1</m> and <m>b=-1</m> so we form the
	  matrix 
	  <m>C'=\mattwo1{1}{-1}1 =
	  \mattwo{\sqrt{2}}00{\sqrt{2}}
	  \mattwo{\cos(-45^\circ)}{-\sin(-45^\circ)}
	  {\sin(-45^\circ)}{\cos(-45^\circ)}</m>.  This shows that
	  <m>C</m> will scale vectors by a factor of <m>\sqrt2</m>
	  while rotating them by <m>-45^\circ</m>. </p></li>
	</ol></p>
      </solution>
                </exercise>
            </page>

            <page>
                <exercise>
                    <title>Summary: <m>2 \times 2</m> Matrices with Complex Eigenvalues</title>
                    <statement>
                        <p>
                            If <m>A</m> has eigenvalues <m>a \pm bi</m>, then
                        </p>
                    </statement>
                    
                    <solution>
                        <p>
                            See <url href="https://understandinglinearalgebra.org/sec-eigen-diag.html#sec-eigen-diag-5-10">Proposition 4.3.12</url>.
                        </p>
                    </solution>
                </exercise>
            </page>

        </worksheet>
    </article>
</pretext>